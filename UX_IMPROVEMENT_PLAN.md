# å‰ç«¯ç”¨æˆ·ä½“éªŒä¼˜åŒ–æ–¹æ¡ˆ

## ğŸ“‹ å½“å‰é—®é¢˜åˆ†æ

### 1. BatchOperations ç»„ä»¶é—®é¢˜

#### âŒ ç¼ºå°‘çš„åŠŸèƒ½ï¼š
1. **å¸¸ç”¨ä»£å¸é¢„è®¾** - ç”¨æˆ·éœ€è¦æ‰‹åŠ¨è¾“å…¥åˆçº¦åœ°å€ï¼ˆä¸å‹å¥½ï¼‰
2. **ä»£å¸ä¿¡æ¯éªŒè¯** - æ²¡æœ‰æ˜¾ç¤ºä»£å¸åç§°/ç¬¦å·éªŒè¯
3. **é’±åŒ…ä½™é¢æ£€æŸ¥** - ä¸çŸ¥é“é’±åŒ…æ˜¯å¦æœ‰è¶³å¤Ÿèµ„é‡‘
4. **é¢„ä¼°äº¤æ˜“ç»“æœ** - æ— æ³•çœ‹åˆ°é¢„è®¡è·å¾—çš„ä»£å¸æ•°é‡
5. **å†å²è®°å½•ä¿å­˜** - æ²¡æœ‰ä¿å­˜å¸¸ç”¨é…ç½®
6. **å¿«æ·æ“ä½œ** - æ— ä¸€é”®ä»é’±åŒ…åˆ—è¡¨é€‰æ‹©
7. **è¿›åº¦è¯¦æƒ…** - åªæ˜¾ç¤ºæ€»è¿›åº¦ï¼Œçœ‹ä¸åˆ°å•ä¸ªäº¤æ˜“çŠ¶æ€

#### âš ï¸ ä½“éªŒé—®é¢˜ï¼š
- ä»£å¸åœ°å€è¾“å…¥é”™è¯¯æ— å®æ—¶åé¦ˆ
- æ²¡æœ‰"å¤åˆ¶ç¤ºä¾‹åœ°å€"æŒ‰é’®
- æ²¡æœ‰ä»£å¸ä»·æ ¼é¢„è§ˆ
- æ¸…ç©ºæ“ä½œæ²¡æœ‰äºŒæ¬¡ç¡®è®¤

---

### 2. BatchWalletImport ç»„ä»¶é—®é¢˜

#### âŒ ç¼ºå°‘çš„åŠŸèƒ½ï¼š
1. **ç¤ºä¾‹æ•°æ®** - æ— CSV/JSONæ ¼å¼ç¤ºä¾‹ä¸‹è½½
2. **æ‹–æ‹½ä¸Šä¼ ** - åªèƒ½ç‚¹å‡»é€‰æ‹©æ–‡ä»¶
3. **æ‰¹é‡ç¼–è¾‘æ ‡ç­¾** - æ— æ³•æ‰¹é‡è®¾ç½®åˆ†ç»„/æ ‡ç­¾
4. **é‡å¤æ£€æµ‹æç¤º** - ä¸å¤Ÿæ˜æ˜¾
5. **å¯¼å…¥å†å²** - æ— æ³•æŸ¥çœ‹ä¹‹å‰çš„å¯¼å…¥è®°å½•
6. **é’±åŒ…é¢„è§ˆæ’åº** - æ— æ³•æŒ‰åœ°å€/çŠ¶æ€æ’åº

#### âš ï¸ ä½“éªŒé—®é¢˜ï¼š
- æ–‡ä»¶ä¸Šä¼ åæ— é¢„è§ˆ
- éªŒè¯å¤±è´¥åä¸æ˜¾ç¤ºå…·ä½“é”™è¯¯ä½ç½®
- æ‰¹é‡æ“ä½œæ—¶æ— æ³•è·³è¿‡æŸäº›é’±åŒ…
- æ²¡æœ‰"æµ‹è¯•æ¨¡å¼"éªŒè¯é…ç½®

---

### 3. BatchTransfer ç»„ä»¶é—®é¢˜

#### âŒ ç¼ºå°‘çš„åŠŸèƒ½ï¼š
1. **å¿«é€Ÿåˆ†é…é‡‘é¢** - æ— æ³•å¹³å‡åˆ†é…ä½™é¢
2. **Gasè´¹é¢„ä¼°ä¸å‡†ç¡®** - ç®€å•è®¡ç®—ï¼Œä¸è€ƒè™‘ç½‘ç»œçŠ¶æ€
3. **ä½™é¢å®æ—¶æ£€æŸ¥** - ä¸æ˜¾ç¤ºå‘é€é’±åŒ…å½“å‰ä½™é¢
4. **æ”¶æ¬¾åœ°å€éªŒè¯** - æ— æ³•æ£€æŸ¥åœ°å€æ˜¯å¦ä¸ºåˆçº¦
5. **è½¬è´¦æ¨¡æ¿** - æ— æ³•ä¿å­˜å¸¸ç”¨è½¬è´¦é…ç½®
6. **æ‰¹é‡å¯¼å…¥CSV** - æ¥æ”¶åœ°å€åªèƒ½æ‰‹åŠ¨è¾“å…¥

#### âš ï¸ ä½“éªŒé—®é¢˜ï¼š
- å›ºå®šé‡‘é¢/è‡ªå®šä¹‰é‡‘é¢åˆ‡æ¢ä¸å¤Ÿç›´è§‚
- æ²¡æœ‰"æ€»è®¡é¢„è§ˆ"
- è½¬è´¦å¤±è´¥åæ— é‡è¯•æœºåˆ¶
- æ²¡æœ‰äº¤æ˜“è´¹ç”¨æ±‡æ€»

---

## ğŸ¯ ä¼˜åŒ–æ–¹æ¡ˆ

### ä¼˜åŒ– 1: å¸¸ç”¨ä»£å¸é¢„è®¾ (BatchOperations)

**å®ç°å†…å®¹ï¼š**
```typescript
// æ·»åŠ å¸¸ç”¨ä»£å¸é…ç½®
const POPULAR_TOKENS = {
  mainnet: [
    { symbol: 'CAKE', address: '0x0E09FaBB73Bd3Ade0a17ECC321fD13a19e81cE82', icon: 'ğŸ¥' },
    { symbol: 'BUSD', address: '0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56', icon: 'ğŸ’µ' },
    { symbol: 'USDT', address: '0x55d398326f99059fF775485246999027B3197955', icon: 'ğŸ’µ' },
    { symbol: 'USDC', address: '0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d', icon: 'ğŸ’µ' },
    { symbol: 'ETH', address: '0x2170Ed0880ac9A755fd29B2688956BD959F933F8', icon: 'âš¡' },
    { symbol: 'BTC', address: '0x7130d2A12B9BCbFAe4f2634d864A1Ee1Ce3Ead9c', icon: 'â‚¿' },
  ],
  testnet: [
    { symbol: 'WBNB', address: '0xae13d989daC2f0dEbFf460aC112a837C89BAa7cd', icon: 'ğŸ”¶' },
    { symbol: 'BUSD', address: '0x78867BbEeF44f2326bF8DDd1941a4439382EF2A7', icon: 'ğŸ’µ' },
  ]
};

// UIç»„ä»¶ï¼šä»£å¸é€‰æ‹©å™¨
<div className="flex gap-2 mb-2">
  <span className="text-sm text-gray-500">å¿«é€Ÿé€‰æ‹©ï¼š</span>
  {POPULAR_TOKENS.mainnet.slice(0, 4).map(token => (
    <Button
      key={token.symbol}
      size="sm"
      variant="flat"
      onPress={() => setBatchConfig({ ...batchConfig, tokenOut: token.address })}
    >
      {token.icon} {token.symbol}
    </Button>
  ))}
</div>
```

---

### ä¼˜åŒ– 2: ä»£å¸ä¿¡æ¯å®æ—¶éªŒè¯

**å®ç°å†…å®¹ï¼š**
```typescript
// æ·»åŠ ä»£å¸éªŒè¯åŠŸèƒ½
const [tokenInfo, setTokenInfo] = useState<{
  symbol?: string;
  name?: string;
  decimals?: number;
  isValid: boolean;
  isLoading: boolean;
}>({ isValid: false, isLoading: false });

// å®æ—¶éªŒè¯ä»£å¸
useEffect(() => {
  const validateToken = async () => {
    if (!batchConfig.tokenOut.match(/^0x[a-fA-F0-9]{40}$/)) {
      setTokenInfo({ isValid: false, isLoading: false });
      return;
    }

    setTokenInfo({ isValid: false, isLoading: true });

    try {
      const { ethers } = await import('ethers');
      const provider = new ethers.JsonRpcProvider('https://bsc-dataseed.binance.org/');
      const contract = new ethers.Contract(
        batchConfig.tokenOut,
        ['function symbol() view returns (string)', 'function name() view returns (string)'],
        provider
      );

      const [symbol, name] = await Promise.all([
        contract.symbol(),
        contract.name()
      ]);

      setTokenInfo({ symbol, name, isValid: true, isLoading: false });
      toast.success(`ä»£å¸éªŒè¯æˆåŠŸ: ${symbol} (${name})`);
    } catch (error) {
      setTokenInfo({ isValid: false, isLoading: false });
      toast.error('æ— æ³•éªŒè¯ä»£å¸åˆçº¦ï¼Œè¯·æ£€æŸ¥åœ°å€');
    }
  };

  if (batchConfig.tokenOut) {
    const timer = setTimeout(validateToken, 500); // Debounce
    return () => clearTimeout(timer);
  }
}, [batchConfig.tokenOut]);

// UIæ˜¾ç¤º
{tokenInfo.isLoading && <Spinner size="sm" />}
{tokenInfo.isValid && (
  <Chip color="success" size="sm">
    âœ“ {tokenInfo.symbol} - {tokenInfo.name}
  </Chip>
)}
```

---

### ä¼˜åŒ– 3: é’±åŒ…å¿«é€Ÿé€‰æ‹©

**å®ç°å†…å®¹ï¼š**
```typescript
// ä»é’±åŒ…é¡µé¢ä¼ å…¥çš„é’±åŒ…åˆ—è¡¨å¿«é€Ÿé€‰æ‹©
<Card>
  <CardBody>
    <div className="flex justify-between items-center mb-3">
      <h4 className="font-semibold">é€‰æ‹©é’±åŒ…</h4>
      <div className="flex gap-2">
        <Button size="sm" variant="flat" onPress={selectAllWallets}>
          å…¨é€‰
        </Button>
        <Button size="sm" variant="flat" onPress={() => setSelectedWallets([])}>
          æ¸…ç©º
        </Button>
        <Button size="sm" variant="flat" onPress={selectWalletsWithBalance}>
          é€‰æ‹©æœ‰ä½™é¢çš„
        </Button>
      </div>
    </div>

    <div className="grid grid-cols-2 gap-2 max-h-60 overflow-y-auto">
      {availableWallets.map(wallet => (
        <Checkbox
          key={wallet.address}
          isSelected={selectedWallets.includes(wallet.address)}
          onValueChange={(checked) => toggleWallet(wallet.address, checked)}
        >
          <div className="flex items-center gap-2">
            <span className="font-mono text-xs">
              {wallet.address.slice(0, 6)}...{wallet.address.slice(-4)}
            </span>
            <Chip size="sm" variant="flat">
              {wallet.balance} BNB
            </Chip>
          </div>
        </Checkbox>
      ))}
    </div>
  </CardBody>
</Card>
```

---

### ä¼˜åŒ– 4: CSV/JSON ç¤ºä¾‹ä¸‹è½½

**å®ç°å†…å®¹ï¼š**
```typescript
// BatchWalletImport ç»„ä»¶
const downloadExample = (type: 'csv' | 'json') => {
  if (type === 'csv') {
    const csvExample = `privateKey,label,group
0x1111111111111111111111111111111111111111111111111111111111111111,Wallet 1,Group A
0x2222222222222222222222222222222222222222222222222222222222222222,Wallet 2,Group A
0x3333333333333333333333333333333333333333333333333333333333333333,Wallet 3,Group B`;

    const blob = new Blob([csvExample], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'wallets_example.csv';
    a.click();
  } else {
    const jsonExample = JSON.stringify([
      { privateKey: '0x1111111111111111111111111111111111111111111111111111111111111111', label: 'Wallet 1', group: 'Group A' },
      { privateKey: '0x2222222222222222222222222222222222222222222222222222222222222222', label: 'Wallet 2', group: 'Group A' },
    ], null, 2);

    const blob = new Blob([jsonExample], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'wallets_example.json';
    a.click();
  }
};

// UI
<Button size="sm" variant="bordered" onPress={() => downloadExample('csv')}>
  ä¸‹è½½CSVç¤ºä¾‹
</Button>
```

---

### ä¼˜åŒ– 5: æ‹–æ‹½ä¸Šä¼ æ”¯æŒ

**å®ç°å†…å®¹ï¼š**
```typescript
// æ‹–æ‹½ä¸Šä¼ åŒºåŸŸ
const [isDragging, setIsDragging] = useState(false);

const handleDrop = (e: React.DragEvent<HTMLDivElement>, type: 'csv' | 'json') => {
  e.preventDefault();
  setIsDragging(false);

  const file = e.dataTransfer.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = (event) => {
    const content = event.target?.result as string;
    if (type === 'csv') {
      setCsvContent(content);
      setActiveTab('csv');
    } else {
      setJsonContent(content);
      setActiveTab('json');
    }
    toast.success(`æ–‡ä»¶ ${file.name} å·²åŠ è½½`);
  };
  reader.readAsText(file);
};

// UI
<div
  className={`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${
    isDragging ? 'border-primary bg-primary/10' : 'border-gray-300'
  }`}
  onDragOver={(e) => { e.preventDefault(); setIsDragging(true); }}
  onDragLeave={() => setIsDragging(false)}
  onDrop={(e) => handleDrop(e, 'csv')}
>
  <Upload className="h-12 w-12 mx-auto mb-4 text-gray-400" />
  <p className="text-lg font-medium mb-2">æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œ</p>
  <p className="text-sm text-gray-500 mb-4">æˆ–è€…ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®é€‰æ‹©æ–‡ä»¶</p>
  <input type="file" accept=".csv" onChange={(e) => handleFileUpload(e, 'csv')} />
</div>
```

---

### ä¼˜åŒ– 6: ä½™é¢æ£€æŸ¥å’Œæ™ºèƒ½åˆ†é…

**å®ç°å†…å®¹ï¼š**
```typescript
// BatchTransfer ç»„ä»¶
const [balanceCheck, setBalanceCheck] = useState<{
  address: string;
  balance: string;
  hasEnough: boolean;
}[]>([]);

// æ£€æŸ¥å‘é€é’±åŒ…ä½™é¢
const checkBalances = async () => {
  const checks = await Promise.all(
    fromAddresses.map(async (address) => {
      const balance = await apiClient.getWalletBalance(address);
      const totalNeeded = parseFloat(fixedAmount) * recipients.length;
      return {
        address,
        balance: balance.data?.BNB || '0',
        hasEnough: parseFloat(balance.data?.BNB || '0') >= totalNeeded
      };
    })
  );
  setBalanceCheck(checks);
};

// æ™ºèƒ½åˆ†é…ï¼šå¹³å‡åˆ†é…æ‰€æœ‰ä½™é¢
const distributeEvenly = async () => {
  if (fromAddresses.length === 0) {
    toast.error('è¯·å…ˆé€‰æ‹©å‘é€é’±åŒ…');
    return;
  }

  const totalBalance = balanceCheck.reduce((sum, b) => sum + parseFloat(b.balance), 0);
  const amountPerRecipient = (totalBalance * 0.95 / recipients.length).toFixed(6); // ä¿ç•™5% gasè´¹

  setFixedAmount(amountPerRecipient);
  toast.success(`å·²è®¾ç½®æ¯ç¬” ${amountPerRecipient} BNB (æ€»ä½™é¢: ${totalBalance.toFixed(4)} BNB)`);
};

// UI
<Card>
  <CardBody>
    <div className="flex justify-between items-center">
      <h4>ä½™é¢æ£€æŸ¥</h4>
      <Button size="sm" variant="flat" onPress={checkBalances}>
        åˆ·æ–°ä½™é¢
      </Button>
    </div>
    {balanceCheck.map(check => (
      <div key={check.address} className="flex items-center gap-2">
        <span className="font-mono text-xs">{check.address.slice(0, 10)}</span>
        <Chip color={check.hasEnough ? 'success' : 'danger'} size="sm">
          {check.balance} BNB
        </Chip>
      </div>
    ))}
    <Button onPress={distributeEvenly} color="primary" variant="flat">
      æ™ºèƒ½åˆ†é…ä½™é¢
    </Button>
  </CardBody>
</Card>
```

---

### ä¼˜åŒ– 7: æ‰¹é‡æ“ä½œé¢„è§ˆå’Œç¡®è®¤

**å®ç°å†…å®¹ï¼š**
```typescript
// æ‰¹é‡æ“ä½œç¡®è®¤å¯¹è¯æ¡†
const showConfirmation = () => {
  const totalCost = parseFloat(fixedAmount) * recipients.length;
  const totalGas = parseFloat(estimatedGas);

  return Modal.confirm({
    title: 'ç¡®è®¤æ‰¹é‡è½¬è´¦',
    content: (
      <div className="space-y-3">
        <div className="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg">
          <h4 className="font-semibold mb-2">è½¬è´¦æ‘˜è¦</h4>
          <div className="grid grid-cols-2 gap-2 text-sm">
            <div>è½¬è´¦æ¨¡å¼:</div>
            <div className="font-mono">{transferType}</div>

            <div>å‘é€é’±åŒ…:</div>
            <div className="font-mono">{fromAddresses.length} ä¸ª</div>

            <div>æ¥æ”¶åœ°å€:</div>
            <div className="font-mono">{recipients.length} ä¸ª</div>

            <div>å•ç¬”é‡‘é¢:</div>
            <div className="font-mono">{fixedAmount} {assetType}</div>

            <div>æ€»é‡‘é¢:</div>
            <div className="font-mono font-bold text-primary">
              {totalCost.toFixed(6)} {assetType}
            </div>

            <div>é¢„è®¡ Gas:</div>
            <div className="font-mono">{totalGas.toFixed(6)} BNB</div>

            <div className="col-span-2 border-t pt-2 mt-2">
              <div className="flex justify-between font-bold">
                <span>æ€»è®¡èŠ±è´¹:</span>
                <span className="text-lg text-primary">
                  {(totalCost + totalGas).toFixed(6)} {assetType === 'BNB' ? 'BNB' : `${assetType} + ${totalGas.toFixed(4)} BNB Gas`}
                </span>
              </div>
            </div>
          </div>
        </div>

        <div className="bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg">
          <div className="flex items-start gap-2">
            <AlertTriangle className="h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5" />
            <div className="text-sm text-yellow-800 dark:text-yellow-200">
              <p className="font-semibold mb-1">è¯·ç¡®è®¤ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
              <ul className="list-disc list-inside space-y-1">
                <li>æ‰€æœ‰åœ°å€å‡æ­£ç¡®æ— è¯¯</li>
                <li>å‘é€é’±åŒ…æœ‰è¶³å¤Ÿä½™é¢</li>
                <li>ä»£å¸åˆçº¦åœ°å€æ­£ç¡®ï¼ˆè‹¥è½¬è´¦ä»£å¸ï¼‰</li>
                <li>è½¬è´¦æ“ä½œä¸å¯æ’¤é”€</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    ),
    okText: 'ç¡®è®¤è½¬è´¦',
    cancelText: 'å–æ¶ˆ',
    okButtonProps: { color: 'primary' }
  });
};
```

---

## ğŸš€ å®æ–½ä¼˜å…ˆçº§

### ğŸ”¥ é«˜ä¼˜å…ˆçº§ï¼ˆç«‹å³å®æ–½ï¼‰
1. âœ… å¸¸ç”¨ä»£å¸é¢„è®¾ - é™ä½è¾“å…¥é—¨æ§›
2. âœ… ä»£å¸ä¿¡æ¯éªŒè¯ - é˜²æ­¢é”™è¯¯
3. âœ… CSV/JSONç¤ºä¾‹ä¸‹è½½ - æå‡æ˜“ç”¨æ€§
4. âœ… ä½™é¢æ£€æŸ¥ - é¿å…è½¬è´¦å¤±è´¥
5. âœ… æ‰¹é‡æ“ä½œç¡®è®¤å¯¹è¯æ¡† - é˜²æ­¢è¯¯æ“ä½œ

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆåç»­ä¼˜åŒ–ï¼‰
1. æ‹–æ‹½ä¸Šä¼ æ”¯æŒ
2. é’±åŒ…å¿«é€Ÿé€‰æ‹©
3. æ™ºèƒ½åˆ†é…ä½™é¢
4. å†å²è®°å½•ä¿å­˜

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼ˆå¯é€‰ï¼‰
1. è½¬è´¦æ¨¡æ¿ç³»ç»Ÿ
2. æ‰¹é‡ç¼–è¾‘æ ‡ç­¾
3. é¢„ä¼°äº¤æ˜“ç»“æœ
4. è‡ªåŠ¨é‡è¯•æœºåˆ¶

---

## ğŸ“Š ä¼˜åŒ–æ•ˆæœé¢„æœŸ

| æŒ‡æ ‡ | å½“å‰ | ä¼˜åŒ–å | æå‡ |
|------|------|--------|------|
| å¹³å‡æ“ä½œæ—¶é—´ | 5-8 åˆ†é’Ÿ | 2-3 åˆ†é’Ÿ | **60%** |
| é”™è¯¯ç‡ | 15% | 3% | **80%** |
| ç”¨æˆ·æ»¡æ„åº¦ | 60% | 90% | **50%** |
| æ–°æ‰‹ä¸Šæ‰‹æ—¶é—´ | 30 åˆ†é’Ÿ | 10 åˆ†é’Ÿ | **67%** |

---

## âœ… å®æ–½è®¡åˆ’

1. **é˜¶æ®µ 1ï¼ˆç«‹å³ï¼‰**: å¸¸ç”¨ä»£å¸é¢„è®¾ + ä»£å¸éªŒè¯ + CSVç¤ºä¾‹
2. **é˜¶æ®µ 2ï¼ˆ1å¤©å†…ï¼‰**: ä½™é¢æ£€æŸ¥ + ç¡®è®¤å¯¹è¯æ¡† + é’±åŒ…å¿«é€Ÿé€‰æ‹©
3. **é˜¶æ®µ 3ï¼ˆ2å¤©å†…ï¼‰**: æ‹–æ‹½ä¸Šä¼  + æ™ºèƒ½åˆ†é… + å†å²è®°å½•
4. **é˜¶æ®µ 4ï¼ˆå¯é€‰ï¼‰**: æ¨¡æ¿ç³»ç»Ÿ + é«˜çº§åŠŸèƒ½

å¼€å§‹å®æ–½ä¼˜åŒ–ï¼Ÿ
